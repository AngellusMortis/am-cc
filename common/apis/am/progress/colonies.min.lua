local a=require("cc.expect")require(settings.get("ghu.base").."core/apis/ghu")local b=require("am.ui.base").BaseObject;local c=require("am.ui")local d=require("am.event")local e=require("am.progress.base")local f=b:extend("am.progress.ColonyProgress")function f:init(g)f.super.init(self)self.id=g;self.status=nil;return self end;local h=e:extend("am.progress.QuarryWrapper")function h:init(i,g,j)h.super.init(self,i,f(g),j)self.names={[d.c.Event.Colonies.status_poll]=true}return self end;function h:createUI()local k=self.screen.id;self.screen:add(c.Text(c.a.Top(),"",{id=k..".titleText"}))local l=c.TabbedFrame(c.a.Anchor(1,3),{id=k..".tabsBase",fillColor=colors.black,border=0,fillVertical=true,fillHorizontal=true})local m=l.tabs[1]local n=2;local o=1;m:add(c.Text(c.a.Left(o),"Raid"))m:add(c.Text(c.a.Right(o,n),"",{id=k..".raid"}))o=o+1;m:add(c.Text(c.a.Left(o),"Happiness"))m:add(c.Text(c.a.Right(o,n),"",{id=k..".happiness"}))o=o+1;m:add(c.Text(c.a.Left(o),"Citizens"))m:add(c.Text(c.a.Right(o,n),"/",{id=k..".citizens"}))o=o+1;m:add(c.Text(c.a.Left(o),"Graves"))m:add(c.Text(c.a.Right(o,n),"",{id=k..".graves"}))o=o+1;m:add(c.Text(c.a.Left(o),"Contructions"))m:add(c.Text(c.a.Right(o,n),"",{id=k..".contructions"}))o=o+1;m:add(c.Text(c.a.Left(o),"Requests"))m:add(c.Text(c.a.Right(o,n),"",{id=k..".requests"}))o=o+1;m:add(c.Text(c.a.Left(o),"Buildings"))m:add(c.Text(c.a.Right(o,n),"",{id=k..".buildings"}))o=o+1;m:add(c.Text(c.a.Left(o),"Visitors"))m:add(c.Text(c.a.Right(o,n),"",{id=k..".visitors"}))o=o+1;m:add(c.Text(c.a.Left(o),"Players"))m:add(c.Text(c.a.Right(o,n),"",{id=k..".players"}))self.screen:add(l)h.super.createUI(self)end;function h:update(p)if p.name==d.c.Event.Colonies.status_poll then self.progress.status=p.status end;local q=self.progress.status;local k=self.screen.id;local r=self.screen:get(k..".titleText")r:update(q.name)local l=self.screen:get(k..".tabsBase")local m=l:getTab(1)local s=m:get(k..".raid")if q.raid then s.obj.textColor=colors.red;s:update("Yes")else s.obj.textColor=colors.green;s:update("No")end;local t=m:get(k..".happiness")if q.happiness<5 then t.obj.textColor=colors.red elseif q.happiness<8 then t.obj.textColor=colors.yellow else t.obj.textColor=colors.green end;t:update(string.format("%d/10",self.progress.status.happiness))local u=m:get(k..".citizens")local v=q.tavernCount*4;local w=q.maxCitizens-v;if q.citizenCount==w then u.obj.textColor=colors.green elseif q.citizenCount>q.maxCitizens then u.obj.textColor=colors.red else u.obj.textColor=colors.yellow end;u:update(string.format("%d/%d",q.citizenCount,q.maxCitizens))local x=m:get(k..".graves")if q.graves>0 then x.obj.textColor=colors.red else x.obj.textColor=colors.green end;x:update(tostring(q.graves))local y=m:get(k..".contructions")y:update(tostring(q.constructionCount))local z=m:get(k..".requests")if#q.requests>0 then z.obj.textColor=colors.yellow else z.obj.textColor=colors.green end;z:update(tostring(#q.requests))local A=m:get(k..".buildings")A:update(tostring(#q.buildings))local B=m:get(k..".visitors")B:update(tostring(q.visitorCount))local C=m:get(k..".players")C:update(tostring(#q.players))end;function h:updateStatus(q)end;function h:handle(p,D)self.screen:handle({p,table.unpack(D)})end;return h
